Attribute VB_Name = "BE_MD2"
'//
'// BE_MD2 is a MD2 model helper module
'//

'DLL declarations for animation routines
Public Declare Sub AnimateLinear Lib "mvbMath.dll" (ByRef vOut As MDLVERTEX, ByRef vFrame0 As MDLVERTEX, ByRef vFrame1 As MDLVERTEX, ByVal nVerts As Long, ByVal t As Single, ByRef vBoxMin As D3DVECTOR, ByRef vBoxMax As D3DVECTOR)
Public Declare Sub AnimateCatmullRom Lib "mvbMath.dll" (ByRef vOut As MDLVERTEX, ByRef vFrame0 As MDLVERTEX, ByRef vFrame1 As MDLVERTEX, ByRef vFrame2 As MDLVERTEX, ByRef vFrame3 As MDLVERTEX, ByVal nVerts As Long, ByVal t As Single, ByRef vBoxMin As D3DVECTOR, ByRef vBoxMax As D3DVECTOR)

'This vertex type is used for MD2 rendering
Public Type MDLVERTEX
    Position As D3DVECTOR
    Normal As D3DVECTOR
    Texture As D3DVECTOR2
End Type
Public Const MDLVERTEX_SIZE As Long = 32
Public Const MDLVERTEX_FVF As Long = (D3DFVF_XYZ Or D3DFVF_TEX1 Or D3DFVF_NORMAL)

Public MD2LightNormals(162) As D3DVECTOR
Public MD2Material As D3DMATERIAL8

Public Function BE_MD2_INIT_LIGHT_NORMALS()
    MD2LightNormals(0) = BE_VERTEX_MAKE_VECTOR(-0.525731, 0, 0.850651)
    MD2LightNormals(1) = BE_VERTEX_MAKE_VECTOR(-0.442863, 0.238856, 0.864188)
    MD2LightNormals(2) = BE_VERTEX_MAKE_VECTOR(-0.295242, 0#, 0.955423)
    MD2LightNormals(3) = BE_VERTEX_MAKE_VECTOR(-0.309017, 0.5, 0.809017)
    MD2LightNormals(4) = BE_VERTEX_MAKE_VECTOR(-0.16246, 0.262866, 0.951056)
    MD2LightNormals(5) = BE_VERTEX_MAKE_VECTOR(0#, 0#, 1#)
    MD2LightNormals(6) = BE_VERTEX_MAKE_VECTOR(0#, 0.850651, 0.525731)
    MD2LightNormals(7) = BE_VERTEX_MAKE_VECTOR(-0.147621, 0.716567, 0.681718)
    MD2LightNormals(8) = BE_VERTEX_MAKE_VECTOR(0.147621, 0.716567, 0.681718)
    MD2LightNormals(9) = BE_VERTEX_MAKE_VECTOR(0#, 0.525731, 0.850651)
    MD2LightNormals(10) = BE_VERTEX_MAKE_VECTOR(0.309017, 0.5, 0.809017)
    MD2LightNormals(11) = BE_VERTEX_MAKE_VECTOR(0.525731, 0#, 0.850651)
    MD2LightNormals(12) = BE_VERTEX_MAKE_VECTOR(0.295242, 0#, 0.955423)
    MD2LightNormals(13) = BE_VERTEX_MAKE_VECTOR(0.442863, 0.238856, 0.864188)
    MD2LightNormals(14) = BE_VERTEX_MAKE_VECTOR(0.16246, 0.262866, 0.951056)
    MD2LightNormals(15) = BE_VERTEX_MAKE_VECTOR(-0.681718, 0.147621, 0.716567)
    MD2LightNormals(16) = BE_VERTEX_MAKE_VECTOR(-0.809017, 0.309017, 0.5)
    MD2LightNormals(17) = BE_VERTEX_MAKE_VECTOR(-0.587785, 0.425325, 0.688191)
    MD2LightNormals(18) = BE_VERTEX_MAKE_VECTOR(-0.850651, 0.525731, 0#)
    MD2LightNormals(19) = BE_VERTEX_MAKE_VECTOR(-0.864188, 0.442863, 0.238856)
    MD2LightNormals(20) = BE_VERTEX_MAKE_VECTOR(-0.716567, 0.681718, 0.147621)
    MD2LightNormals(21) = BE_VERTEX_MAKE_VECTOR(-0.688191, 0.587785, 0.425325)
    MD2LightNormals(22) = BE_VERTEX_MAKE_VECTOR(-0.5, 0.809017, 0.309017)
    MD2LightNormals(23) = BE_VERTEX_MAKE_VECTOR(-0.238856, 0.864188, 0.442863)
    MD2LightNormals(24) = BE_VERTEX_MAKE_VECTOR(-0.425325, 0.688191, 0.587785)
    MD2LightNormals(25) = BE_VERTEX_MAKE_VECTOR(-0.716567, 0.681718, -0.147621)
    MD2LightNormals(26) = BE_VERTEX_MAKE_VECTOR(-0.5, 0.809017, -0.309017)
    MD2LightNormals(27) = BE_VERTEX_MAKE_VECTOR(-0.525731, 0.850651, 0#)
    MD2LightNormals(28) = BE_VERTEX_MAKE_VECTOR(0#, 0.850651, -0.525731)
    MD2LightNormals(29) = BE_VERTEX_MAKE_VECTOR(-0.238856, 0.864188, -0.442863)
    MD2LightNormals(30) = BE_VERTEX_MAKE_VECTOR(0#, 0.955423, -0.295242)
    MD2LightNormals(31) = BE_VERTEX_MAKE_VECTOR(-0.262866, 0.951056, -0.16246)
    MD2LightNormals(32) = BE_VERTEX_MAKE_VECTOR(0#, 1#, 0#)
    MD2LightNormals(33) = BE_VERTEX_MAKE_VECTOR(0#, 0.955423, 0.295242)
    MD2LightNormals(34) = BE_VERTEX_MAKE_VECTOR(-0.262866, 0.951056, 0.16246)
    MD2LightNormals(35) = BE_VERTEX_MAKE_VECTOR(0.238856, 0.864188, 0.442863)
    MD2LightNormals(36) = BE_VERTEX_MAKE_VECTOR(0.262866, 0.951056, 0.16246)
    MD2LightNormals(37) = BE_VERTEX_MAKE_VECTOR(0.5, 0.809017, 0.309017)
    MD2LightNormals(38) = BE_VERTEX_MAKE_VECTOR(0.238856, 0.864188, -0.442863)
    MD2LightNormals(39) = BE_VERTEX_MAKE_VECTOR(0.262866, 0.951056, -0.16246)
    MD2LightNormals(40) = BE_VERTEX_MAKE_VECTOR(0.5, 0.809017, -0.309017)
    MD2LightNormals(41) = BE_VERTEX_MAKE_VECTOR(0.850651, 0.525731, 0#)
    MD2LightNormals(42) = BE_VERTEX_MAKE_VECTOR(0.716567, 0.681718, 0.147621)
    MD2LightNormals(43) = BE_VERTEX_MAKE_VECTOR(0.716567, 0.681718, -0.147621)
    MD2LightNormals(44) = BE_VERTEX_MAKE_VECTOR(0.525731, 0.850651, 0#)
    MD2LightNormals(45) = BE_VERTEX_MAKE_VECTOR(0.425325, 0.688191, 0.587785)
    MD2LightNormals(46) = BE_VERTEX_MAKE_VECTOR(0.864188, 0.442863, 0.238856)
    MD2LightNormals(47) = BE_VERTEX_MAKE_VECTOR(0.688191, 0.587785, 0.425325)
    MD2LightNormals(48) = BE_VERTEX_MAKE_VECTOR(0.809017, 0.309017, 0.5)
    MD2LightNormals(49) = BE_VERTEX_MAKE_VECTOR(0.681718, 0.147621, 0.716567)
    MD2LightNormals(50) = BE_VERTEX_MAKE_VECTOR(0.587785, 0.425325, 0.688191)
    MD2LightNormals(51) = BE_VERTEX_MAKE_VECTOR(0.955423, 0.295242, 0#)
    MD2LightNormals(52) = BE_VERTEX_MAKE_VECTOR(1#, 0#, 0#)
    MD2LightNormals(53) = BE_VERTEX_MAKE_VECTOR(0.951056, 0.16246, 0.262866)
    MD2LightNormals(54) = BE_VERTEX_MAKE_VECTOR(0.850651, -0.525731, 0#)
    MD2LightNormals(55) = BE_VERTEX_MAKE_VECTOR(0.955423, -0.295242, 0#)
    MD2LightNormals(56) = BE_VERTEX_MAKE_VECTOR(0.864188, -0.442863, 0.238856)
    MD2LightNormals(57) = BE_VERTEX_MAKE_VECTOR(0.951056, -0.16246, 0.262866)
    MD2LightNormals(58) = BE_VERTEX_MAKE_VECTOR(0.809017, -0.309017, 0.5)
    MD2LightNormals(59) = BE_VERTEX_MAKE_VECTOR(0.681718, -0.147621, 0.716567)
    MD2LightNormals(60) = BE_VERTEX_MAKE_VECTOR(0.850651, 0#, 0.525731)
    MD2LightNormals(61) = BE_VERTEX_MAKE_VECTOR(0.864188, 0.442863, -0.238856)
    MD2LightNormals(62) = BE_VERTEX_MAKE_VECTOR(0.809017, 0.309017, -0.5)
    MD2LightNormals(63) = BE_VERTEX_MAKE_VECTOR(0.951056, 0.16246, -0.262866)
    MD2LightNormals(64) = BE_VERTEX_MAKE_VECTOR(0.525731, 0#, -0.850651)
    MD2LightNormals(65) = BE_VERTEX_MAKE_VECTOR(0.681718, 0.147621, -0.716567)
    MD2LightNormals(66) = BE_VERTEX_MAKE_VECTOR(0.681718, -0.147621, -0.716567)
    MD2LightNormals(67) = BE_VERTEX_MAKE_VECTOR(0.850651, 0#, -0.525731)
    MD2LightNormals(68) = BE_VERTEX_MAKE_VECTOR(0.809017, -0.309017, -0.5)
    MD2LightNormals(69) = BE_VERTEX_MAKE_VECTOR(0.864188, -0.442863, -0.238856)
    MD2LightNormals(70) = BE_VERTEX_MAKE_VECTOR(0.951056, -0.16246, -0.262866)
    MD2LightNormals(71) = BE_VERTEX_MAKE_VECTOR(0.147621, 0.716567, -0.681718)
    MD2LightNormals(72) = BE_VERTEX_MAKE_VECTOR(0.309017, 0.5, -0.809017)
    MD2LightNormals(73) = BE_VERTEX_MAKE_VECTOR(0.425325, 0.688191, -0.587785)
    MD2LightNormals(74) = BE_VERTEX_MAKE_VECTOR(0.442863, 0.238856, -0.864188)
    MD2LightNormals(75) = BE_VERTEX_MAKE_VECTOR(0.587785, 0.425325, -0.688191)
    MD2LightNormals(76) = BE_VERTEX_MAKE_VECTOR(0.688191, 0.587785, -0.425325)
    MD2LightNormals(77) = BE_VERTEX_MAKE_VECTOR(-0.147621, 0.716567, -0.681718)
    MD2LightNormals(78) = BE_VERTEX_MAKE_VECTOR(-0.309017, 0.5, -0.809017)
    MD2LightNormals(79) = BE_VERTEX_MAKE_VECTOR(0#, 0.525731, -0.850651)
    MD2LightNormals(80) = BE_VERTEX_MAKE_VECTOR(-0.525731, 0#, -0.850651)
    MD2LightNormals(81) = BE_VERTEX_MAKE_VECTOR(-0.442863, 0.238856, -0.864188)
    MD2LightNormals(82) = BE_VERTEX_MAKE_VECTOR(-0.295242, 0#, -0.955423)
    MD2LightNormals(83) = BE_VERTEX_MAKE_VECTOR(-0.16246, 0.262866, -0.951056)
    MD2LightNormals(84) = BE_VERTEX_MAKE_VECTOR(0#, 0#, -1#)
    MD2LightNormals(85) = BE_VERTEX_MAKE_VECTOR(0.295242, 0#, -0.955423)
    MD2LightNormals(86) = BE_VERTEX_MAKE_VECTOR(0.16246, 0.262866, -0.951056)
    MD2LightNormals(87) = BE_VERTEX_MAKE_VECTOR(-0.442863, -0.238856, -0.864188)
    MD2LightNormals(88) = BE_VERTEX_MAKE_VECTOR(-0.309017, -0.5, -0.809017)
    MD2LightNormals(89) = BE_VERTEX_MAKE_VECTOR(-0.16246, -0.262866, -0.951056)
    MD2LightNormals(90) = BE_VERTEX_MAKE_VECTOR(0#, -0.850651, -0.525731)
    MD2LightNormals(91) = BE_VERTEX_MAKE_VECTOR(-0.147621, -0.716567, -0.681718)
    MD2LightNormals(92) = BE_VERTEX_MAKE_VECTOR(0.147621, -0.716567, -0.681718)
    MD2LightNormals(93) = BE_VERTEX_MAKE_VECTOR(0#, -0.525731, -0.850651)
    MD2LightNormals(94) = BE_VERTEX_MAKE_VECTOR(0.309017, -0.5, -0.809017)
    MD2LightNormals(95) = BE_VERTEX_MAKE_VECTOR(0.442863, -0.238856, -0.864188)
    MD2LightNormals(96) = BE_VERTEX_MAKE_VECTOR(0.16246, -0.262866, -0.951056)
    MD2LightNormals(97) = BE_VERTEX_MAKE_VECTOR(0.238856, -0.864188, -0.442863)
    MD2LightNormals(98) = BE_VERTEX_MAKE_VECTOR(0.5, -0.809017, -0.309017)
    MD2LightNormals(99) = BE_VERTEX_MAKE_VECTOR(0.425325, -0.688191, -0.587785)
    MD2LightNormals(100) = BE_VERTEX_MAKE_VECTOR(0.716567, -0.681718, -0.147621)
    MD2LightNormals(101) = BE_VERTEX_MAKE_VECTOR(0.688191, -0.587785, -0.425325)
    MD2LightNormals(102) = BE_VERTEX_MAKE_VECTOR(0.587785, -0.425325, -0.688191)
    MD2LightNormals(103) = BE_VERTEX_MAKE_VECTOR(0#, -0.955423, -0.295242)
    MD2LightNormals(104) = BE_VERTEX_MAKE_VECTOR(0#, -1#, 0#)
    MD2LightNormals(105) = BE_VERTEX_MAKE_VECTOR(0.262866, -0.951056, -0.16246)
    MD2LightNormals(106) = BE_VERTEX_MAKE_VECTOR(0#, -0.850651, 0.525731)
    MD2LightNormals(107) = BE_VERTEX_MAKE_VECTOR(0#, -0.955423, 0.295242)
    MD2LightNormals(108) = BE_VERTEX_MAKE_VECTOR(0.238856, -0.864188, 0.442863)
    MD2LightNormals(109) = BE_VERTEX_MAKE_VECTOR(0.262866, -0.951056, 0.16246)
    MD2LightNormals(110) = BE_VERTEX_MAKE_VECTOR(0.5, -0.809017, 0.309017)
    MD2LightNormals(111) = BE_VERTEX_MAKE_VECTOR(0.716567, -0.681718, 0.147621)
    MD2LightNormals(112) = BE_VERTEX_MAKE_VECTOR(0.525731, -0.850651, 0#)
    MD2LightNormals(113) = BE_VERTEX_MAKE_VECTOR(-0.238856, -0.864188, -0.442863)
    MD2LightNormals(114) = BE_VERTEX_MAKE_VECTOR(-0.5, -0.809017, -0.309017)
    MD2LightNormals(115) = BE_VERTEX_MAKE_VECTOR(-0.262866, -0.951056, -0.16246)
    MD2LightNormals(116) = BE_VERTEX_MAKE_VECTOR(-0.850651, -0.525731, 0#)
    MD2LightNormals(117) = BE_VERTEX_MAKE_VECTOR(-0.716567, -0.681718, -0.147621)
    MD2LightNormals(118) = BE_VERTEX_MAKE_VECTOR(-0.716567, -0.681718, 0.147621)
    MD2LightNormals(119) = BE_VERTEX_MAKE_VECTOR(-0.525731, -0.850651, 0#)
    MD2LightNormals(120) = BE_VERTEX_MAKE_VECTOR(-0.5, -0.809017, 0.309017)
    MD2LightNormals(121) = BE_VERTEX_MAKE_VECTOR(-0.238856, -0.864188, 0.442863)
    MD2LightNormals(122) = BE_VERTEX_MAKE_VECTOR(-0.262866, -0.951056, 0.16246)
    MD2LightNormals(123) = BE_VERTEX_MAKE_VECTOR(-0.864188, -0.442863, 0.238856)
    MD2LightNormals(124) = BE_VERTEX_MAKE_VECTOR(-0.809017, -0.309017, 0.5)
    MD2LightNormals(125) = BE_VERTEX_MAKE_VECTOR(-0.688191, -0.587785, 0.425325)
    MD2LightNormals(126) = BE_VERTEX_MAKE_VECTOR(-0.681718, -0.147621, 0.716567)
    MD2LightNormals(127) = BE_VERTEX_MAKE_VECTOR(-0.442863, -0.238856, 0.864188)
    MD2LightNormals(128) = BE_VERTEX_MAKE_VECTOR(-0.587785, -0.425325, 0.688191)
    MD2LightNormals(129) = BE_VERTEX_MAKE_VECTOR(-0.309017, -0.5, 0.809017)
    MD2LightNormals(130) = BE_VERTEX_MAKE_VECTOR(-0.147621, -0.716567, 0.681718)
    MD2LightNormals(131) = BE_VERTEX_MAKE_VECTOR(-0.425325, -0.688191, 0.587785)
    MD2LightNormals(132) = BE_VERTEX_MAKE_VECTOR(-0.16246, -0.262866, 0.951056)
    MD2LightNormals(133) = BE_VERTEX_MAKE_VECTOR(0.442863, -0.238856, 0.864188)
    MD2LightNormals(134) = BE_VERTEX_MAKE_VECTOR(0.16246, -0.262866, 0.951056)
    MD2LightNormals(135) = BE_VERTEX_MAKE_VECTOR(0.309017, -0.5, 0.809017)
    MD2LightNormals(136) = BE_VERTEX_MAKE_VECTOR(0.147621, -0.716567, 0.681718)
    MD2LightNormals(137) = BE_VERTEX_MAKE_VECTOR(0#, -0.525731, 0.850651)
    MD2LightNormals(138) = BE_VERTEX_MAKE_VECTOR(0.425325, -0.688191, 0.587785)
    MD2LightNormals(139) = BE_VERTEX_MAKE_VECTOR(0.587785, -0.425325, 0.688191)
    MD2LightNormals(140) = BE_VERTEX_MAKE_VECTOR(0.688191, -0.587785, 0.425325)
    MD2LightNormals(141) = BE_VERTEX_MAKE_VECTOR(-0.955423, 0.295242, 0#)
    MD2LightNormals(142) = BE_VERTEX_MAKE_VECTOR(-0.951056, 0.16246, 0.262866)
    MD2LightNormals(143) = BE_VERTEX_MAKE_VECTOR(-1#, 0#, 0#)
    MD2LightNormals(144) = BE_VERTEX_MAKE_VECTOR(-0.850651, 0#, 0.525731)
    MD2LightNormals(145) = BE_VERTEX_MAKE_VECTOR(-0.955423, -0.295242, 0#)
    MD2LightNormals(146) = BE_VERTEX_MAKE_VECTOR(-0.951056, -0.16246, 0.262866)
    MD2LightNormals(147) = BE_VERTEX_MAKE_VECTOR(-0.864188, 0.442863, -0.238856)
    MD2LightNormals(148) = BE_VERTEX_MAKE_VECTOR(-0.951056, 0.16246, -0.262866)
    MD2LightNormals(149) = BE_VERTEX_MAKE_VECTOR(-0.809017, 0.309017, -0.5)
    MD2LightNormals(150) = BE_VERTEX_MAKE_VECTOR(-0.864188, -0.442863, -0.238856)
    MD2LightNormals(151) = BE_VERTEX_MAKE_VECTOR(-0.951056, -0.16246, -0.262866)
    MD2LightNormals(152) = BE_VERTEX_MAKE_VECTOR(-0.809017, -0.309017, -0.5)
    MD2LightNormals(153) = BE_VERTEX_MAKE_VECTOR(-0.681718, 0.147621, -0.716567)
    MD2LightNormals(154) = BE_VERTEX_MAKE_VECTOR(-0.681718, -0.147621, -0.716567)
    MD2LightNormals(155) = BE_VERTEX_MAKE_VECTOR(-0.850651, 0#, -0.525731)
    MD2LightNormals(156) = BE_VERTEX_MAKE_VECTOR(-0.688191, 0.587785, -0.425325)
    MD2LightNormals(157) = BE_VERTEX_MAKE_VECTOR(-0.587785, 0.425325, -0.688191)
    MD2LightNormals(158) = BE_VERTEX_MAKE_VECTOR(-0.425325, 0.688191, -0.587785)
    MD2LightNormals(159) = BE_VERTEX_MAKE_VECTOR(-0.425325, -0.688191, -0.587785)
    MD2LightNormals(160) = BE_VERTEX_MAKE_VECTOR(-0.587785, -0.425325, -0.688191)
    MD2LightNormals(161) = BE_VERTEX_MAKE_VECTOR(-0.688191, -0.587785, -0.425325)
    
    'set ident material
    MD2Material.Ambient.a = 1
    MD2Material.Ambient.R = 1
    MD2Material.Ambient.G = 1
    MD2Material.Ambient.b = 1
    
    MD2Material.diffuse.a = 1
    MD2Material.diffuse.R = 1
    MD2Material.diffuse.G = 1
    MD2Material.diffuse.b = 1
    
    MD2Material.power = 10
    
    D3Device.SetMaterial MD2Material
End Function
